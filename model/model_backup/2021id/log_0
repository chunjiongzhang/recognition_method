opt = Namespace(PCB=False, alpha=1.0, batchsize=48, color_jitter=False, data_dir='data/market/pytorch', erasing_p=0.5, gpu_ids='0', lr=0.1, name='sggnn', net_loss_model=0, save_model_name='0', train_all=True, use_dense=True)
net_loss_model = 0
save_model_name = 0
[Resize(size=(256, 128), interpolation=PIL.Image.BICUBIC), Pad(padding=10, fill=0, padding_mode=constant), RandomCrop(size=(256, 128), padding=0), RandomHorizontalFlip(p=0.5), ToTensor(), Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225]), <random_erasing.RandomErasing object at 0x7f8ee1ac2080>]
9.5367431640625e-07
class_num = 2027
model_siamese structure
Epoch 0/99
----------
train Loss_id: 0.1296 Loss_verify: 0.0138 Loss_space: 0.0000  Acc_id: 0.4443 Acc_verify: 0.6210 
Epoch 1/99
----------
train Loss_id: 0.0291 Loss_verify: 0.0123 Loss_space: 0.0000  Acc_id: 0.8260 Acc_verify: 0.8416 
Epoch 2/99
----------
train Loss_id: 0.0170 Loss_verify: 0.0114 Loss_space: 0.0000  Acc_id: 0.9005 Acc_verify: 0.9033 
Epoch 3/99
----------
train Loss_id: 0.0134 Loss_verify: 0.0108 Loss_space: 0.0000  Acc_id: 0.9239 Acc_verify: 0.9235 
Epoch 4/99
----------
train Loss_id: 0.0111 Loss_verify: 0.0103 Loss_space: 0.0000  Acc_id: 0.9404 Acc_verify: 0.9499 
Epoch 5/99
----------
train Loss_id: 0.0099 Loss_verify: 0.0100 Loss_space: 0.0000  Acc_id: 0.9499 Acc_verify: 0.9544 
Epoch 6/99
----------
train Loss_id: 0.0090 Loss_verify: 0.0098 Loss_space: 0.0000  Acc_id: 0.9554 Acc_verify: 0.9605 
Epoch 7/99
----------
train Loss_id: 0.0090 Loss_verify: 0.0096 Loss_space: 0.0000  Acc_id: 0.9557 Acc_verify: 0.9609 
Epoch 8/99
----------
train Loss_id: 0.0082 Loss_verify: 0.0095 Loss_space: 0.0000  Acc_id: 0.9609 Acc_verify: 0.9668 
Epoch 9/99
----------
train Loss_id: 0.0076 Loss_verify: 0.0094 Loss_space: 0.0000  Acc_id: 0.9651 Acc_verify: 0.9678 
Epoch 10/99
----------
train Loss_id: 0.0076 Loss_verify: 0.0093 Loss_space: 0.0000  Acc_id: 0.9655 Acc_verify: 0.9696 
Epoch 11/99
----------
train Loss_id: 0.0069 Loss_verify: 0.0092 Loss_space: 0.0000  Acc_id: 0.9706 Acc_verify: 0.9715 
Epoch 12/99
----------
train Loss_id: 0.0070 Loss_verify: 0.0092 Loss_space: 0.0000  Acc_id: 0.9694 Acc_verify: 0.9723 
Epoch 13/99
----------
train Loss_id: 0.0066 Loss_verify: 0.0091 Loss_space: 0.0000  Acc_id: 0.9719 Acc_verify: 0.9718 
Epoch 14/99
----------
train Loss_id: 0.0062 Loss_verify: 0.0090 Loss_space: 0.0000  Acc_id: 0.9747 Acc_verify: 0.9750 
Epoch 15/99
----------
train Loss_id: 0.0030 Loss_verify: 0.0088 Loss_space: 0.0000  Acc_id: 0.9909 Acc_verify: 0.9857 
Epoch 16/99
----------
train Loss_id: 0.0026 Loss_verify: 0.0087 Loss_space: 0.0000  Acc_id: 0.9945 Acc_verify: 0.9890 
Epoch 17/99
----------
train Loss_id: 0.0026 Loss_verify: 0.0086 Loss_space: 0.0000  Acc_id: 0.9958 Acc_verify: 0.9891 
Epoch 18/99
----------
train Loss_id: 0.0026 Loss_verify: 0.0086 Loss_space: 0.0000  Acc_id: 0.9960 Acc_verify: 0.9895 
Epoch 19/99
----------
train Loss_id: 0.0027 Loss_verify: 0.0085 Loss_space: 0.0000  Acc_id: 0.9966 Acc_verify: 0.9889 
Epoch 20/99
----------
train Loss_id: 0.0028 Loss_verify: 0.0085 Loss_space: 0.0000  Acc_id: 0.9961 Acc_verify: 0.9895 
Epoch 21/99
----------
train Loss_id: 0.0026 Loss_verify: 0.0084 Loss_space: 0.0000  Acc_id: 0.9969 Acc_verify: 0.9902 
Epoch 22/99
----------
train Loss_id: 0.0027 Loss_verify: 0.0084 Loss_space: 0.0000  Acc_id: 0.9966 Acc_verify: 0.9907 
Epoch 23/99
----------
train Loss_id: 0.0026 Loss_verify: 0.0083 Loss_space: 0.0000  Acc_id: 0.9972 Acc_verify: 0.9907 
Epoch 24/99
----------
train Loss_id: 0.0026 Loss_verify: 0.0083 Loss_space: 0.0000  Acc_id: 0.9970 Acc_verify: 0.9912 
Epoch 25/99
----------
train Loss_id: 0.0026 Loss_verify: 0.0083 Loss_space: 0.0000  Acc_id: 0.9971 Acc_verify: 0.9914 
Epoch 26/99
----------
train Loss_id: 0.0026 Loss_verify: 0.0083 Loss_space: 0.0000  Acc_id: 0.9972 Acc_verify: 0.9902 
Epoch 27/99
----------
train Loss_id: 0.0026 Loss_verify: 0.0082 Loss_space: 0.0000  Acc_id: 0.9968 Acc_verify: 0.9913 
Epoch 28/99
----------
train Loss_id: 0.0026 Loss_verify: 0.0081 Loss_space: 0.0000  Acc_id: 0.9972 Acc_verify: 0.9915 
Epoch 29/99
----------
train Loss_id: 0.0025 Loss_verify: 0.0081 Loss_space: 0.0000  Acc_id: 0.9976 Acc_verify: 0.9915 
Epoch 30/99
----------
train Loss_id: 0.0022 Loss_verify: 0.0080 Loss_space: 0.0000  Acc_id: 0.9982 Acc_verify: 0.9926 
Epoch 31/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0080 Loss_space: 0.0000  Acc_id: 0.9979 Acc_verify: 0.9930 
Epoch 32/99
----------
train Loss_id: 0.0021 Loss_verify: 0.0080 Loss_space: 0.0000  Acc_id: 0.9982 Acc_verify: 0.9925 
Epoch 33/99
----------
train Loss_id: 0.0021 Loss_verify: 0.0080 Loss_space: 0.0000  Acc_id: 0.9982 Acc_verify: 0.9923 
Epoch 34/99
----------
train Loss_id: 0.0021 Loss_verify: 0.0080 Loss_space: 0.0000  Acc_id: 0.9986 Acc_verify: 0.9928 
Epoch 35/99
----------
train Loss_id: 0.0022 Loss_verify: 0.0079 Loss_space: 0.0000  Acc_id: 0.9983 Acc_verify: 0.9934 
Epoch 36/99
----------
train Loss_id: 0.0021 Loss_verify: 0.0079 Loss_space: 0.0000  Acc_id: 0.9986 Acc_verify: 0.9924 
Epoch 37/99
----------
train Loss_id: 0.0022 Loss_verify: 0.0079 Loss_space: 0.0000  Acc_id: 0.9986 Acc_verify: 0.9918 
Epoch 38/99
----------
train Loss_id: 0.0021 Loss_verify: 0.0079 Loss_space: 0.0000  Acc_id: 0.9985 Acc_verify: 0.9934 
Epoch 39/99
----------
train Loss_id: 0.0021 Loss_verify: 0.0079 Loss_space: 0.0000  Acc_id: 0.9985 Acc_verify: 0.9931 
Epoch 40/99
----------
train Loss_id: 0.0022 Loss_verify: 0.0079 Loss_space: 0.0000  Acc_id: 0.9984 Acc_verify: 0.9925 
Epoch 41/99
----------
train Loss_id: 0.0021 Loss_verify: 0.0078 Loss_space: 0.0000  Acc_id: 0.9985 Acc_verify: 0.9925 
Epoch 42/99
----------
train Loss_id: 0.0021 Loss_verify: 0.0079 Loss_space: 0.0000  Acc_id: 0.9985 Acc_verify: 0.9924 
Epoch 43/99
----------
train Loss_id: 0.0022 Loss_verify: 0.0078 Loss_space: 0.0000  Acc_id: 0.9985 Acc_verify: 0.9930 
Epoch 44/99
----------
train Loss_id: 0.0021 Loss_verify: 0.0078 Loss_space: 0.0000  Acc_id: 0.9986 Acc_verify: 0.9928 
Epoch 45/99
----------
train Loss_id: 0.0021 Loss_verify: 0.0078 Loss_space: 0.0000  Acc_id: 0.9986 Acc_verify: 0.9921 
Epoch 46/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0078 Loss_space: 0.0000  Acc_id: 0.9985 Acc_verify: 0.9926 
Epoch 47/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0078 Loss_space: 0.0000  Acc_id: 0.9989 Acc_verify: 0.9928 
Epoch 48/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0078 Loss_space: 0.0000  Acc_id: 0.9986 Acc_verify: 0.9923 
Epoch 49/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0078 Loss_space: 0.0000  Acc_id: 0.9987 Acc_verify: 0.9926 
Epoch 50/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0078 Loss_space: 0.0000  Acc_id: 0.9988 Acc_verify: 0.9933 
Epoch 51/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0078 Loss_space: 0.0000  Acc_id: 0.9988 Acc_verify: 0.9926 
Epoch 52/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9988 Acc_verify: 0.9933 
Epoch 53/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9989 Acc_verify: 0.9936 
Epoch 54/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0078 Loss_space: 0.0000  Acc_id: 0.9988 Acc_verify: 0.9929 
Epoch 55/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9990 Acc_verify: 0.9926 
Epoch 56/99
----------
train Loss_id: 0.0021 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9987 Acc_verify: 0.9928 
Epoch 57/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9990 Acc_verify: 0.9933 
Epoch 58/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9988 Acc_verify: 0.9923 
Epoch 59/99
----------
train Loss_id: 0.0021 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9986 Acc_verify: 0.9930 
Epoch 60/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9988 Acc_verify: 0.9926 
Epoch 61/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9989 Acc_verify: 0.9923 
Epoch 62/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9988 Acc_verify: 0.9920 
Epoch 63/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9987 Acc_verify: 0.9932 
Epoch 64/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9991 Acc_verify: 0.9935 
Epoch 65/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9987 Acc_verify: 0.9927 
Epoch 66/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9988 Acc_verify: 0.9928 
Epoch 67/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9989 Acc_verify: 0.9930 
Epoch 68/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9987 Acc_verify: 0.9934 
Epoch 69/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9988 Acc_verify: 0.9922 
Epoch 70/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9988 Acc_verify: 0.9930 
Epoch 71/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9988 Acc_verify: 0.9926 
Epoch 72/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9990 Acc_verify: 0.9919 
Epoch 73/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9988 Acc_verify: 0.9930 
Epoch 74/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9988 Acc_verify: 0.9934 
Epoch 75/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9987 Acc_verify: 0.9936 
Epoch 76/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9987 Acc_verify: 0.9923 
Epoch 77/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9989 Acc_verify: 0.9928 
Epoch 78/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9988 Acc_verify: 0.9940 
Epoch 79/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9988 Acc_verify: 0.9934 
Epoch 80/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9989 Acc_verify: 0.9917 
Epoch 81/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9988 Acc_verify: 0.9927 
Epoch 82/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9988 Acc_verify: 0.9934 
Epoch 83/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9988 Acc_verify: 0.9936 
Epoch 84/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9986 Acc_verify: 0.9921 
Epoch 85/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9987 Acc_verify: 0.9928 
Epoch 86/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9987 Acc_verify: 0.9927 
Epoch 87/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9990 Acc_verify: 0.9932 
Epoch 88/99
----------
train Loss_id: 0.0019 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9988 Acc_verify: 0.9924 
Epoch 89/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9989 Acc_verify: 0.9928 
Epoch 90/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9989 Acc_verify: 0.9933 
Epoch 91/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9987 Acc_verify: 0.9934 
Epoch 92/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9989 Acc_verify: 0.9930 
Epoch 93/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9987 Acc_verify: 0.9934 
Epoch 94/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9988 Acc_verify: 0.9930 
Epoch 95/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9988 Acc_verify: 0.9922 
Epoch 96/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9989 Acc_verify: 0.9930 
Epoch 97/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9988 Acc_verify: 0.9941 
Epoch 98/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9984 Acc_verify: 0.9942 
Epoch 99/99
----------
train Loss_id: 0.0020 Loss_verify: 0.0077 Loss_space: 0.0000  Acc_id: 0.9988 Acc_verify: 0.9930 
best_epoch = 97     best_loss = 0.004836668452876581     best_acc = 0.9964414040906577
Training complete in 333m 55s
This is not an error. If you want to use low precision, i.e., fp16, please install the apex with cuda support (https://github.com/NVIDIA/apex) and update pytorch to 1.0
opt = Namespace(PCB=False, batchsize=48, fp16=False, gpu_ids='0', name='sggnn', test_dir='data/market/pytorch', use_dense=True, which_epoch='best_siamese')
opt.gpu_ids = 0
opt.which_epoch = best_siamese
opt.test_dir = data/market/pytorch
opt.name = sggnn
opt.batchsize = 48
opt.use_dense = True
opt.PCB = False
opt.fp16 = False
-------test-----------
load easy pretrained model: ./model/sggnn/net_best_siamese.pth
torch.Size([3368, 512])
i =    0    CMC_tmp[0] = 1  real-time rank1 = 1.0000  avg rank1 = 1.0000
i =  100    CMC_tmp[0] = 0  real-time rank1 = 0.8020  avg rank1 = 0.8119
i =  200    CMC_tmp[0] = 1  real-time rank1 = 0.8119  avg rank1 = 0.8159
i =  300    CMC_tmp[0] = 1  real-time rank1 = 0.8218  avg rank1 = 0.8206
i =  400    CMC_tmp[0] = 1  real-time rank1 = 0.8020  avg rank1 = 0.8180
i =  500    CMC_tmp[0] = 1  real-time rank1 = 0.9505  avg rank1 = 0.8463
i =  600    CMC_tmp[0] = 1  real-time rank1 = 0.8911  avg rank1 = 0.8552
i =  700    CMC_tmp[0] = 1  real-time rank1 = 0.9703  avg rank1 = 0.8730
i =  800    CMC_tmp[0] = 1  real-time rank1 = 0.9802  avg rank1 = 0.8876
i =  900    CMC_tmp[0] = 1  real-time rank1 = 0.9505  avg rank1 = 0.8957
i = 1000    CMC_tmp[0] = 1  real-time rank1 = 0.8812  avg rank1 = 0.8951
i = 1100    CMC_tmp[0] = 1  real-time rank1 = 0.9505  avg rank1 = 0.9010
i = 1200    CMC_tmp[0] = 1  real-time rank1 = 0.8713  avg rank1 = 0.8993
i = 1300    CMC_tmp[0] = 1  real-time rank1 = 0.9703  avg rank1 = 0.9055
i = 1400    CMC_tmp[0] = 1  real-time rank1 = 0.8812  avg rank1 = 0.9044
i = 1500    CMC_tmp[0] = 1  real-time rank1 = 0.9406  avg rank1 = 0.9074
i = 1600    CMC_tmp[0] = 1  real-time rank1 = 0.9109  avg rank1 = 0.9082
i = 1700    CMC_tmp[0] = 1  real-time rank1 = 0.9604  avg rank1 = 0.9118
i = 1800    CMC_tmp[0] = 0  real-time rank1 = 0.9406  avg rank1 = 0.9139
i = 1900    CMC_tmp[0] = 1  real-time rank1 = 0.9505  avg rank1 = 0.9164
i = 2000    CMC_tmp[0] = 1  real-time rank1 = 0.9505  avg rank1 = 0.9185
i = 2100    CMC_tmp[0] = 1  real-time rank1 = 0.9604  avg rank1 = 0.9210
i = 2200    CMC_tmp[0] = 1  real-time rank1 = 0.8713  avg rank1 = 0.9191
i = 2300    CMC_tmp[0] = 1  real-time rank1 = 0.9307  avg rank1 = 0.9200
i = 2400    CMC_tmp[0] = 1  real-time rank1 = 0.9406  avg rank1 = 0.9213
i = 2500    CMC_tmp[0] = 1  real-time rank1 = 0.9208  avg rank1 = 0.9216
i = 2600    CMC_tmp[0] = 1  real-time rank1 = 0.9703  avg rank1 = 0.9239
i = 2700    CMC_tmp[0] = 1  real-time rank1 = 0.9703  avg rank1 = 0.9260
i = 2800    CMC_tmp[0] = 1  real-time rank1 = 0.9307  avg rank1 = 0.9265
i = 2900    CMC_tmp[0] = 1  real-time rank1 = 0.9802  avg rank1 = 0.9286
i = 3000    CMC_tmp[0] = 1  real-time rank1 = 0.9703  avg rank1 = 0.9304
i = 3100    CMC_tmp[0] = 1  real-time rank1 = 0.9406  avg rank1 = 0.9310
i = 3200    CMC_tmp[0] = 1  real-time rank1 = 0.9802  avg rank1 = 0.9328
i = 3300    CMC_tmp[0] = 1  real-time rank1 = 0.9604  avg rank1 = 0.9340
i = 3367    CMC_tmp[0] = 1  real-time rank1 = 0.9706  avg rank1 = 0.9350
Rank@1:0.934976 Rank@5:0.978622 Rank@10:0.986342 mAP:0.833743
calculate initial distance
Reranking complete in 1m 6s
top1:0.947447 top5:0.972090 top10:0.979513 mAP:0.919143
This is not an error. If you want to use low precision, i.e., fp16, please install the apex with cuda support (https://github.com/NVIDIA/apex) and update pytorch to 1.0
opt = Namespace(PCB=False, batchsize=48, fp16=False, gpu_ids='0', name='sggnn', test_dir='data/market/pytorch', use_dense=True, which_epoch='last_siamese')
opt.gpu_ids = 0
opt.which_epoch = last_siamese
opt.test_dir = data/market/pytorch
opt.name = sggnn
opt.batchsize = 48
opt.use_dense = True
opt.PCB = False
opt.fp16 = False
-------test-----------
load easy pretrained model: ./model/sggnn/net_last_siamese.pth
torch.Size([3368, 512])
i =    0    CMC_tmp[0] = 1  real-time rank1 = 1.0000  avg rank1 = 1.0000
i =  100    CMC_tmp[0] = 0  real-time rank1 = 0.7921  avg rank1 = 0.8020
i =  200    CMC_tmp[0] = 1  real-time rank1 = 0.8119  avg rank1 = 0.8109
i =  300    CMC_tmp[0] = 1  real-time rank1 = 0.8218  avg rank1 = 0.8173
i =  400    CMC_tmp[0] = 1  real-time rank1 = 0.8020  avg rank1 = 0.8155
i =  500    CMC_tmp[0] = 1  real-time rank1 = 0.9505  avg rank1 = 0.8443
i =  600    CMC_tmp[0] = 1  real-time rank1 = 0.8812  avg rank1 = 0.8519
i =  700    CMC_tmp[0] = 1  real-time rank1 = 0.9703  avg rank1 = 0.8702
i =  800    CMC_tmp[0] = 1  real-time rank1 = 0.9802  avg rank1 = 0.8851
i =  900    CMC_tmp[0] = 1  real-time rank1 = 0.9505  avg rank1 = 0.8935
i = 1000    CMC_tmp[0] = 1  real-time rank1 = 0.8812  avg rank1 = 0.8931
i = 1100    CMC_tmp[0] = 1  real-time rank1 = 0.9406  avg rank1 = 0.8983
i = 1200    CMC_tmp[0] = 1  real-time rank1 = 0.8713  avg rank1 = 0.8968
i = 1300    CMC_tmp[0] = 1  real-time rank1 = 0.9703  avg rank1 = 0.9032
i = 1400    CMC_tmp[0] = 1  real-time rank1 = 0.8812  avg rank1 = 0.9022
i = 1500    CMC_tmp[0] = 1  real-time rank1 = 0.9406  avg rank1 = 0.9054
i = 1600    CMC_tmp[0] = 1  real-time rank1 = 0.9109  avg rank1 = 0.9063
i = 1700    CMC_tmp[0] = 1  real-time rank1 = 0.9604  avg rank1 = 0.9101
i = 1800    CMC_tmp[0] = 0  real-time rank1 = 0.9307  avg rank1 = 0.9117
i = 1900    CMC_tmp[0] = 1  real-time rank1 = 0.9505  avg rank1 = 0.9143
i = 2000    CMC_tmp[0] = 1  real-time rank1 = 0.9604  avg rank1 = 0.9170
i = 2100    CMC_tmp[0] = 1  real-time rank1 = 0.9604  avg rank1 = 0.9196
i = 2200    CMC_tmp[0] = 1  real-time rank1 = 0.8812  avg rank1 = 0.9182
i = 2300    CMC_tmp[0] = 1  real-time rank1 = 0.9307  avg rank1 = 0.9192
i = 2400    CMC_tmp[0] = 1  real-time rank1 = 0.9406  avg rank1 = 0.9204
i = 2500    CMC_tmp[0] = 1  real-time rank1 = 0.9307  avg rank1 = 0.9212
i = 2600    CMC_tmp[0] = 1  real-time rank1 = 0.9703  avg rank1 = 0.9235
i = 2700    CMC_tmp[0] = 1  real-time rank1 = 0.9604  avg rank1 = 0.9252
i = 2800    CMC_tmp[0] = 1  real-time rank1 = 0.9307  avg rank1 = 0.9257
i = 2900    CMC_tmp[0] = 1  real-time rank1 = 0.9802  avg rank1 = 0.9280
i = 3000    CMC_tmp[0] = 1  real-time rank1 = 0.9703  avg rank1 = 0.9297
i = 3100    CMC_tmp[0] = 1  real-time rank1 = 0.9406  avg rank1 = 0.9303
i = 3200    CMC_tmp[0] = 1  real-time rank1 = 0.9703  avg rank1 = 0.9319
i = 3300    CMC_tmp[0] = 1  real-time rank1 = 0.9505  avg rank1 = 0.9327
i = 3367    CMC_tmp[0] = 1  real-time rank1 = 0.9853  avg rank1 = 0.9341
Rank@1:0.934085 Rank@5:0.979513 Rank@10:0.985748 mAP:0.833741
calculate initial distance
Reranking complete in 1m 6s
top1:0.943884 top5:0.971200 top10:0.978919 mAP:0.918814
                if opt.net_loss_model == 0:
                    r1 = 0.5
                    r2 = 0.5
                    r3 = 0.00
                elif opt.net_loss_model == 1:
                    r1 = 0.4
                    r2 = 0.6
                    r3 = 0.1
                elif opt.net_loss_model == 2:
                    r1 = 0.6
                    r2 = 0.4
                    r3 = 0.1

