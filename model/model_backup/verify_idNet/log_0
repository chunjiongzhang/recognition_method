opt = Namespace(PCB=False, alpha=1.0, batchsize=48, color_jitter=False, data_dir='data/market/pytorch', erasing_p=0.5, gpu_ids='0', lr=0.1, name='sggnn', net_loss_model=0, save_model_name='0', train_all=True, use_dense=True)
net_loss_model = 0
save_model_name = 0
[Resize(size=(256, 128), interpolation=PIL.Image.BICUBIC), Pad(padding=10, fill=0, padding_mode=constant), RandomCrop(size=(256, 128), padding=0), RandomHorizontalFlip(p=0.5), ToTensor(), Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225]), <random_erasing.RandomErasing object at 0x7fbae270a048>]
9.5367431640625e-07
model_siamese structure
Epoch 0/99
----------
train Loss_id: 0.1603 Loss_verif: 0.0138  Acc_id: 0.3400 Verif_Acc: 0.6400 
Epoch 1/99
----------
train Loss_id: 0.0571 Loss_verif: 0.0124  Acc_id: 0.7241 Verif_Acc: 0.8144 
Epoch 2/99
----------
train Loss_id: 0.0381 Loss_verif: 0.0113  Acc_id: 0.8302 Verif_Acc: 0.8741 
Epoch 3/99
----------
train Loss_id: 0.0299 Loss_verif: 0.0105  Acc_id: 0.8765 Verif_Acc: 0.9057 
Epoch 4/99
----------
train Loss_id: 0.0259 Loss_verif: 0.0099  Acc_id: 0.8963 Verif_Acc: 0.9226 
Epoch 5/99
----------
train Loss_id: 0.0228 Loss_verif: 0.0095  Acc_id: 0.9134 Verif_Acc: 0.9305 
Epoch 6/99
----------
train Loss_id: 0.0209 Loss_verif: 0.0091  Acc_id: 0.9217 Verif_Acc: 0.9377 
Epoch 7/99
----------
train Loss_id: 0.0195 Loss_verif: 0.0088  Acc_id: 0.9306 Verif_Acc: 0.9443 
Epoch 8/99
----------
train Loss_id: 0.0177 Loss_verif: 0.0085  Acc_id: 0.9386 Verif_Acc: 0.9506 
Epoch 9/99
----------
train Loss_id: 0.0182 Loss_verif: 0.0084  Acc_id: 0.9349 Verif_Acc: 0.9503 
Epoch 10/99
----------
train Loss_id: 0.0168 Loss_verif: 0.0082  Acc_id: 0.9464 Verif_Acc: 0.9493 
Epoch 11/99
----------
train Loss_id: 0.0159 Loss_verif: 0.0081  Acc_id: 0.9501 Verif_Acc: 0.9533 
Epoch 12/99
----------
train Loss_id: 0.0155 Loss_verif: 0.0080  Acc_id: 0.9517 Verif_Acc: 0.9568 
Epoch 13/99
----------
train Loss_id: 0.0154 Loss_verif: 0.0079  Acc_id: 0.9522 Verif_Acc: 0.9575 
Epoch 14/99
----------
train Loss_id: 0.0149 Loss_verif: 0.0078  Acc_id: 0.9555 Verif_Acc: 0.9596 
Epoch 15/99
----------
train Loss_id: 0.0153 Loss_verif: 0.0077  Acc_id: 0.9530 Verif_Acc: 0.9588 
Epoch 16/99
----------
train Loss_id: 0.0145 Loss_verif: 0.0077  Acc_id: 0.9579 Verif_Acc: 0.9578 
Epoch 17/99
----------
train Loss_id: 0.0136 Loss_verif: 0.0075  Acc_id: 0.9619 Verif_Acc: 0.9611 
Epoch 18/99
----------
train Loss_id: 0.0135 Loss_verif: 0.0075  Acc_id: 0.9630 Verif_Acc: 0.9624 
Epoch 19/99
----------
train Loss_id: 0.0130 Loss_verif: 0.0074  Acc_id: 0.9649 Verif_Acc: 0.9621 
Epoch 20/99
----------
train Loss_id: 0.0135 Loss_verif: 0.0074  Acc_id: 0.9624 Verif_Acc: 0.9628 
Epoch 21/99
----------
train Loss_id: 0.0133 Loss_verif: 0.0074  Acc_id: 0.9642 Verif_Acc: 0.9624 
Epoch 22/99
----------
train Loss_id: 0.0134 Loss_verif: 0.0074  Acc_id: 0.9615 Verif_Acc: 0.9607 
Epoch 23/99
----------
train Loss_id: 0.0130 Loss_verif: 0.0073  Acc_id: 0.9640 Verif_Acc: 0.9648 
Epoch 24/99
----------
train Loss_id: 0.0135 Loss_verif: 0.0074  Acc_id: 0.9621 Verif_Acc: 0.9622 
Epoch 25/99
----------
train Loss_id: 0.0137 Loss_verif: 0.0073  Acc_id: 0.9593 Verif_Acc: 0.9631 
Epoch 26/99
----------
train Loss_id: 0.0122 Loss_verif: 0.0073  Acc_id: 0.9698 Verif_Acc: 0.9634 
Epoch 27/99
----------
train Loss_id: 0.0121 Loss_verif: 0.0072  Acc_id: 0.9704 Verif_Acc: 0.9648 
Epoch 28/99
----------
train Loss_id: 0.0114 Loss_verif: 0.0071  Acc_id: 0.9742 Verif_Acc: 0.9669 
Epoch 29/99
----------
train Loss_id: 0.0120 Loss_verif: 0.0070  Acc_id: 0.9699 Verif_Acc: 0.9652 
Epoch 30/99
----------
train Loss_id: 0.0097 Loss_verif: 0.0069  Acc_id: 0.9845 Verif_Acc: 0.9722 
Epoch 31/99
----------
train Loss_id: 0.0084 Loss_verif: 0.0067  Acc_id: 0.9921 Verif_Acc: 0.9768 
Epoch 32/99
----------
train Loss_id: 0.0082 Loss_verif: 0.0067  Acc_id: 0.9924 Verif_Acc: 0.9759 
Epoch 33/99
----------
train Loss_id: 0.0080 Loss_verif: 0.0066  Acc_id: 0.9938 Verif_Acc: 0.9775 
Epoch 34/99
----------
train Loss_id: 0.0078 Loss_verif: 0.0066  Acc_id: 0.9942 Verif_Acc: 0.9756 
Epoch 35/99
----------
train Loss_id: 0.0076 Loss_verif: 0.0065  Acc_id: 0.9955 Verif_Acc: 0.9783 
Epoch 36/99
----------
train Loss_id: 0.0077 Loss_verif: 0.0065  Acc_id: 0.9950 Verif_Acc: 0.9760 
Epoch 37/99
----------
train Loss_id: 0.0075 Loss_verif: 0.0064  Acc_id: 0.9955 Verif_Acc: 0.9769 
Epoch 38/99
----------
train Loss_id: 0.0074 Loss_verif: 0.0063  Acc_id: 0.9961 Verif_Acc: 0.9797 
Epoch 39/99
----------
train Loss_id: 0.0074 Loss_verif: 0.0063  Acc_id: 0.9958 Verif_Acc: 0.9783 
Epoch 40/99
----------
train Loss_id: 0.0073 Loss_verif: 0.0062  Acc_id: 0.9962 Verif_Acc: 0.9768 
Epoch 41/99
----------
train Loss_id: 0.0072 Loss_verif: 0.0062  Acc_id: 0.9962 Verif_Acc: 0.9772 
Epoch 42/99
----------
train Loss_id: 0.0073 Loss_verif: 0.0062  Acc_id: 0.9957 Verif_Acc: 0.9742 
Epoch 43/99
----------
train Loss_id: 0.0072 Loss_verif: 0.0061  Acc_id: 0.9971 Verif_Acc: 0.9801 
Epoch 44/99
----------
train Loss_id: 0.0072 Loss_verif: 0.0061  Acc_id: 0.9964 Verif_Acc: 0.9750 
Epoch 45/99
----------
train Loss_id: 0.0072 Loss_verif: 0.0061  Acc_id: 0.9962 Verif_Acc: 0.9750 
Epoch 46/99
----------
train Loss_id: 0.0072 Loss_verif: 0.0061  Acc_id: 0.9967 Verif_Acc: 0.9744 
Epoch 47/99
----------
train Loss_id: 0.0070 Loss_verif: 0.0060  Acc_id: 0.9971 Verif_Acc: 0.9751 
Epoch 48/99
----------
train Loss_id: 0.0071 Loss_verif: 0.0060  Acc_id: 0.9970 Verif_Acc: 0.9746 
Epoch 49/99
----------
train Loss_id: 0.0071 Loss_verif: 0.0060  Acc_id: 0.9970 Verif_Acc: 0.9734 
Epoch 50/99
----------
train Loss_id: 0.0071 Loss_verif: 0.0059  Acc_id: 0.9966 Verif_Acc: 0.9748 
Epoch 51/99
----------
train Loss_id: 0.0070 Loss_verif: 0.0059  Acc_id: 0.9974 Verif_Acc: 0.9748 
Epoch 52/99
----------
train Loss_id: 0.0069 Loss_verif: 0.0059  Acc_id: 0.9976 Verif_Acc: 0.9768 
Epoch 53/99
----------
train Loss_id: 0.0069 Loss_verif: 0.0058  Acc_id: 0.9970 Verif_Acc: 0.9746 
Epoch 54/99
----------
train Loss_id: 0.0069 Loss_verif: 0.0058  Acc_id: 0.9972 Verif_Acc: 0.9741 
Epoch 55/99
----------
train Loss_id: 0.0069 Loss_verif: 0.0058  Acc_id: 0.9976 Verif_Acc: 0.9758 
Epoch 56/99
----------
train Loss_id: 0.0068 Loss_verif: 0.0058  Acc_id: 0.9978 Verif_Acc: 0.9738 
Epoch 57/99
----------
train Loss_id: 0.0067 Loss_verif: 0.0057  Acc_id: 0.9976 Verif_Acc: 0.9744 
Epoch 58/99
----------
train Loss_id: 0.0069 Loss_verif: 0.0058  Acc_id: 0.9974 Verif_Acc: 0.9717 
Epoch 59/99
----------
train Loss_id: 0.0067 Loss_verif: 0.0057  Acc_id: 0.9981 Verif_Acc: 0.9724 
Epoch 60/99
----------
train Loss_id: 0.0067 Loss_verif: 0.0057  Acc_id: 0.9973 Verif_Acc: 0.9723 
Epoch 61/99
----------
train Loss_id: 0.0067 Loss_verif: 0.0057  Acc_id: 0.9980 Verif_Acc: 0.9734 
Epoch 62/99
----------
train Loss_id: 0.0066 Loss_verif: 0.0057  Acc_id: 0.9983 Verif_Acc: 0.9751 
Epoch 63/99
----------
train Loss_id: 0.0066 Loss_verif: 0.0056  Acc_id: 0.9981 Verif_Acc: 0.9751 
Epoch 64/99
----------
train Loss_id: 0.0067 Loss_verif: 0.0057  Acc_id: 0.9978 Verif_Acc: 0.9725 
Epoch 65/99
----------
train Loss_id: 0.0066 Loss_verif: 0.0056  Acc_id: 0.9981 Verif_Acc: 0.9767 
Epoch 66/99
----------
train Loss_id: 0.0066 Loss_verif: 0.0057  Acc_id: 0.9986 Verif_Acc: 0.9727 
Epoch 67/99
----------
train Loss_id: 0.0067 Loss_verif: 0.0056  Acc_id: 0.9978 Verif_Acc: 0.9725 
Epoch 68/99
----------
train Loss_id: 0.0066 Loss_verif: 0.0056  Acc_id: 0.9983 Verif_Acc: 0.9737 
Epoch 69/99
----------
train Loss_id: 0.0066 Loss_verif: 0.0057  Acc_id: 0.9982 Verif_Acc: 0.9733 
Epoch 70/99
----------
train Loss_id: 0.0067 Loss_verif: 0.0056  Acc_id: 0.9980 Verif_Acc: 0.9727 
Epoch 71/99
----------
train Loss_id: 0.0066 Loss_verif: 0.0056  Acc_id: 0.9982 Verif_Acc: 0.9738 
Epoch 72/99
----------
train Loss_id: 0.0065 Loss_verif: 0.0056  Acc_id: 0.9987 Verif_Acc: 0.9741 
Epoch 73/99
----------
train Loss_id: 0.0066 Loss_verif: 0.0056  Acc_id: 0.9986 Verif_Acc: 0.9737 
Epoch 74/99
----------
train Loss_id: 0.0066 Loss_verif: 0.0056  Acc_id: 0.9983 Verif_Acc: 0.9746 
Epoch 75/99
----------
train Loss_id: 0.0066 Loss_verif: 0.0056  Acc_id: 0.9982 Verif_Acc: 0.9729 
Epoch 76/99
----------
train Loss_id: 0.0066 Loss_verif: 0.0056  Acc_id: 0.9977 Verif_Acc: 0.9741 
Epoch 77/99
----------
train Loss_id: 0.0066 Loss_verif: 0.0056  Acc_id: 0.9979 Verif_Acc: 0.9741 
Epoch 78/99
----------
train Loss_id: 0.0066 Loss_verif: 0.0056  Acc_id: 0.9981 Verif_Acc: 0.9713 
Epoch 79/99
----------
train Loss_id: 0.0066 Loss_verif: 0.0056  Acc_id: 0.9983 Verif_Acc: 0.9747 
Epoch 80/99
----------
train Loss_id: 0.0066 Loss_verif: 0.0056  Acc_id: 0.9983 Verif_Acc: 0.9738 
Epoch 81/99
----------
train Loss_id: 0.0066 Loss_verif: 0.0056  Acc_id: 0.9983 Verif_Acc: 0.9732 
Epoch 82/99
----------
train Loss_id: 0.0066 Loss_verif: 0.0056  Acc_id: 0.9979 Verif_Acc: 0.9727 
Epoch 83/99
----------
train Loss_id: 0.0066 Loss_verif: 0.0056  Acc_id: 0.9979 Verif_Acc: 0.9747 
Epoch 84/99
----------
train Loss_id: 0.0066 Loss_verif: 0.0056  Acc_id: 0.9981 Verif_Acc: 0.9744 
Epoch 85/99
----------
train Loss_id: 0.0065 Loss_verif: 0.0056  Acc_id: 0.9982 Verif_Acc: 0.9765 
Epoch 86/99
----------
train Loss_id: 0.0065 Loss_verif: 0.0056  Acc_id: 0.9985 Verif_Acc: 0.9756 
Epoch 87/99
----------
train Loss_id: 0.0065 Loss_verif: 0.0056  Acc_id: 0.9982 Verif_Acc: 0.9741 
Epoch 88/99
----------
train Loss_id: 0.0066 Loss_verif: 0.0056  Acc_id: 0.9983 Verif_Acc: 0.9715 
Epoch 89/99
----------
train Loss_id: 0.0066 Loss_verif: 0.0056  Acc_id: 0.9982 Verif_Acc: 0.9723 
Epoch 90/99
----------
train Loss_id: 0.0066 Loss_verif: 0.0056  Acc_id: 0.9980 Verif_Acc: 0.9743 
Epoch 91/99
----------
train Loss_id: 0.0066 Loss_verif: 0.0056  Acc_id: 0.9976 Verif_Acc: 0.9734 
Epoch 92/99
----------
train Loss_id: 0.0066 Loss_verif: 0.0056  Acc_id: 0.9978 Verif_Acc: 0.9748 
Epoch 93/99
----------
train Loss_id: 0.0066 Loss_verif: 0.0056  Acc_id: 0.9979 Verif_Acc: 0.9741 
Epoch 94/99
----------
train Loss_id: 0.0065 Loss_verif: 0.0056  Acc_id: 0.9981 Verif_Acc: 0.9734 
Epoch 95/99
----------
train Loss_id: 0.0065 Loss_verif: 0.0055  Acc_id: 0.9979 Verif_Acc: 0.9745 
Epoch 96/99
----------
train Loss_id: 0.0067 Loss_verif: 0.0056  Acc_id: 0.9979 Verif_Acc: 0.9720 
Epoch 97/99
----------
train Loss_id: 0.0066 Loss_verif: 0.0056  Acc_id: 0.9982 Verif_Acc: 0.9717 
Epoch 98/99
----------
train Loss_id: 0.0065 Loss_verif: 0.0056  Acc_id: 0.9984 Verif_Acc: 0.9740 
Epoch 99/99
----------
train Loss_id: 0.0066 Loss_verif: 0.0056  Acc_id: 0.9982 Verif_Acc: 0.9740 
best_epoch = 43     best_loss = 0.006644859725939482     best_acc = 0.9885765179677819
Training complete in 153m 50s
/home/dl/anaconda3/envs/pytorch_4_env/bin/python /home/dl/cf/reid_siamese_gcn/evaluate_gpu.py
torch.Size([3368, 512])
i =    0    CMC_tmp[0] = 1  real-time rank1 = 1.0000  avg rank1 = 1.0000
i =  100    CMC_tmp[0] = 0  real-time rank1 = 0.8317  avg rank1 = 0.8416
i =  200    CMC_tmp[0] = 1  real-time rank1 = 0.7624  avg rank1 = 0.8060
i =  300    CMC_tmp[0] = 1  real-time rank1 = 0.8317  avg rank1 = 0.8173
i =  400    CMC_tmp[0] = 1  real-time rank1 = 0.7426  avg rank1 = 0.8005
i =  500    CMC_tmp[0] = 1  real-time rank1 = 0.9505  avg rank1 = 0.8323
i =  600    CMC_tmp[0] = 1  real-time rank1 = 0.8317  avg rank1 = 0.8336
i =  700    CMC_tmp[0] = 1  real-time rank1 = 0.9406  avg rank1 = 0.8502
i =  800    CMC_tmp[0] = 1  real-time rank1 = 0.9406  avg rank1 = 0.8627
i =  900    CMC_tmp[0] = 0  real-time rank1 = 0.8911  avg rank1 = 0.8668
i = 1000    CMC_tmp[0] = 1  real-time rank1 = 0.8812  avg rank1 = 0.8691
i = 1100    CMC_tmp[0] = 1  real-time rank1 = 0.9307  avg rank1 = 0.8756
i = 1200    CMC_tmp[0] = 1  real-time rank1 = 0.9109  avg rank1 = 0.8793
i = 1300    CMC_tmp[0] = 1  real-time rank1 = 0.9406  avg rank1 = 0.8847
i = 1400    CMC_tmp[0] = 1  real-time rank1 = 0.9406  avg rank1 = 0.8894
i = 1500    CMC_tmp[0] = 1  real-time rank1 = 0.9604  avg rank1 = 0.8947
i = 1600    CMC_tmp[0] = 1  real-time rank1 = 0.8713  avg rank1 = 0.8938
i = 1700    CMC_tmp[0] = 1  real-time rank1 = 0.9505  avg rank1 = 0.8977
i = 1800    CMC_tmp[0] = 1  real-time rank1 = 0.9109  avg rank1 = 0.8989
i = 1900    CMC_tmp[0] = 1  real-time rank1 = 0.8713  avg rank1 = 0.8979
i = 2000    CMC_tmp[0] = 1  real-time rank1 = 0.9703  avg rank1 = 0.9020
i = 2100    CMC_tmp[0] = 1  real-time rank1 = 0.9703  avg rank1 = 0.9058
i = 2200    CMC_tmp[0] = 1  real-time rank1 = 0.9109  avg rank1 = 0.9064
i = 2300    CMC_tmp[0] = 1  real-time rank1 = 0.8911  avg rank1 = 0.9061
i = 2400    CMC_tmp[0] = 1  real-time rank1 = 0.9109  avg rank1 = 0.9067
i = 2500    CMC_tmp[0] = 1  real-time rank1 = 0.9307  avg rank1 = 0.9080
i = 2600    CMC_tmp[0] = 1  real-time rank1 = 0.9406  avg rank1 = 0.9097
i = 2700    CMC_tmp[0] = 1  real-time rank1 = 0.9505  avg rank1 = 0.9115
i = 2800    CMC_tmp[0] = 0  real-time rank1 = 0.9208  avg rank1 = 0.9122
i = 2900    CMC_tmp[0] = 1  real-time rank1 = 0.9802  avg rank1 = 0.9149
i = 3000    CMC_tmp[0] = 1  real-time rank1 = 0.9604  avg rank1 = 0.9167
i = 3100    CMC_tmp[0] = 1  real-time rank1 = 0.9505  avg rank1 = 0.9181
i = 3200    CMC_tmp[0] = 1  real-time rank1 = 0.9406  avg rank1 = 0.9191
i = 3300    CMC_tmp[0] = 1  real-time rank1 = 0.9505  avg rank1 = 0.9203
i = 3367    CMC_tmp[0] = 1  real-time rank1 = 0.9412  avg rank1 = 0.9210
Rank@1:0.921021 Rank@5:0.972981 Rank@10:0.984857 mAP:0.806638

calculate initial distance
Reranking complete in 1m 17s
top1:0.932304 top5:0.966746 top10:0.976544 mAP:0.908657



